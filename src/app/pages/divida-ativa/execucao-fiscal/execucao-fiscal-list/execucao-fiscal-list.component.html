<app-bread-crumb [itens]="[{text: 'Execução Fiscal'}]"></app-bread-crumb>
<div class="row mb-4">
  <div class="col-md-9">
    <h3 class="text-themecolor border-left pl-2" style="font-family: sans-serif; color: pur">Execução Fiscal</h3>
  </div>
</div>

<div>
    <button type="button" class="btn btn-secondary float-right" (click)="invertSumir()"
      [title]="sumir ? 'Mostrar Pesquisa' : 'Esconder Pesquisa'">
      <i [class]="sumir ? 'fa fa-search-plus' : 'fa fa-search-minus'"></i>
    </button>
    <br>
    <br>
  </div>
  <div class="for-row" *ngIf="!sumir">
    <div class="card">
      <div class="card-body">
        <div class="table-responsive-lg" style="background: white;font-family: sans-serif;">
          <table class="table table-striped table-bordered" style="font-size: 0.8rem;">
            <tbody>
              <tr>
                <td width="15%" class="text-left">
                  <strong>Data do Processo De:</strong>
                </td>
                <td width="35%" class="text-left">
                  <p-calendar id="date" [(ngModel)]="de" inputStyleClass="form-control" dataType="string"
                    dateFormat="dd/mm/yy" [locale]="ptBR" [showButtonBar]="true" [style]="{'width':'100%'}"
                    placeholder="Data do Processo De" title="Data do Processo De">
                  </p-calendar>
                </td>
                <td width="15%" class="text-left">
                  <strong>Data do Processo Até:</strong>
                </td>
                <td width="35%" class="text-left">
                  <p-calendar id="date" [(ngModel)]="ate" inputStyleClass="form-control" dataType="string"
                    dateFormat="dd/mm/yy" [locale]="ptBR" [showButtonBar]="true" [style]="{'width':'100%'}"
                    placeholder="Data do Processo Até" title="Data do Processo Até">
                  </p-calendar>
                </td>
              </tr>
              <tr>
                <td width="15%" class="text-left">
                  <strong>CNPJ, CEI, CPF:</strong>
                </td>
                <td width="35%" class="text-left">
                  <input [(ngModel)]="ccc" type="text" class="form-control" [imask]="maskCnpjCpfCei"
                    placeholder="CNPJ, CEI, CPF" title="CNPJ, CEI, CPF">
                </td>
                <td width="15%" class="text-left">
                  <strong>Número do Processo:</strong>
                </td>
                <td width="35%" class="text-left">
                  <input [(ngModel)]="placa" type="text" class="form-control" placeholder="Número do Processo"
                    title="Número do Processo">
                </td>
              </tr>
              <tr>
                <td width="15%" class="text-left">
                  <strong>Razão Social ou Nome:</strong>
                </td>
                <td width="35%" class="text-left">
                  <input [(ngModel)]="rn" type="text" class="form-control"
                    placeholder="Razão Social ou Nome" title="Razão Social ou Nome">
                </td>
                <td width="15%" class="text-left">
                  <strong>Número do Auto de Infração:</strong>
                </td>
                <td width="35%" class="text-left">
                  <input [(ngModel)]="nai" type="text" class="form-control" placeholder="Número do Auto de Infração"
                    title="Número do Auto de Infração">
                </td>
              </tr>
              <tr>
                <td width="15%" class="text-left">
                  <strong>Situação da Execução Fiscal:</strong>
                </td>
                <td width="35%" class="text-left">
                  <select [(ngModel)]="sit" id="situacao" class="form-control" title="Situação">
                    <option [value]="null">Todos</option>
                    <option *ngFor="let option of situacaoExecucaoOptions" [value]="option.value">{{ option.text }}</option>
                  </select>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <button type="button" class="btn btn-secondary mt-3 float-right" (click)="pesquisar()"
          title="Pesquisar Registros">
          <i class="fa fa-search"></i>
          Pesquisar
        </button>
      </div>
    </div>
  </div>
<div class="table-responsive-lg" style="background: white;font-family: sans-serif;">
  <table class="table table-hover table-bordered" style="font-size: 0.8rem;">
    <thead>
      <tr>
        <th scope="col" class="text-center">Código</th>
        <th scope="col" class="text-center">Nome Interessado</th>
        <th scope="col" class="text-center">CNPJ, CEI, CPF</th>
        <th scope="col" class="text-center">Data Atualização</th>
        <th scope="col" class="text-center">Origem do Cadastro</th>
        <th scope="col" class="text-center">Situação</th>
        <th scope="col" class="text-center">Analista Responsável</th>
        <th scope="col" class="text-center">Situação da Execução Fiscal</th>
        <th scope="col" class="text-center">Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let obj of paginas.content" 
        [ngStyle]="{'background-color': (obj.debito.isAtrasoNotificacao ? '#ff7b7b' : (obj.debito.isAtrasoTramite ? '#ffff88' : '')) }">
        <td class="text-center">
          <span *ngIf="obj.debito.id < 10">0</span>{{ obj.id }}&nbsp;
          <span class="badge badge-success" *ngIf="obj.visualizado">Novo</span>
        </td>
        <td class="text-center">
          {{ obj.debito.devedor.razaoSocialNome ? obj.debito.devedor.razaoSocialNome : '-' }}
        </td>
        <td class="text-center">
          {{ obj.debito.devedor.cnpjCpfCei ? obj.debito.devedor.cnpjCpfCei : '-' }}
        </td>
        <td class="text-center">
          {{ obj.debito.dataAtualizacao | date:'dd/MM/yyyy HH:mm:ss' }}
        </td>
        <td class="text-center">
          {{ getOrigemCadastro(obj.debito.origemCadastro) }}
        </td>
        <td class="text-center">
          {{ getSituacao(obj.debito.situacao) }}
        </td>
        <td class="text-center">
          {{ obj.debito.nomeUsuario ? obj.debito.nomeUsuario : '-' }}
        </td>
        <td class="text-center">
          {{ getSituacaoExecucao(obj.id) }}
        </td>
        <td class="text-center">
          <button type="button" class="btn btn btn-sm" (click)="limparTime()" [routerLink]="[obj.id, 'edit']" title="Vizualizar">
            <i class="fa fa-eye"></i>
          </button>
          <a class="btn btn btn-sm" [href]="'#/dividaativa/debito/execucaofiscal/' + obj.debito.id + '/tramite'" title="Trâmite">
            <i class="fa fa-exchange"></i></a>
        </td>
      </tr>
      <tr *ngIf="paginas.totalElements <= 0 || paginas == ''">
        <td colspan="8">
          <strong>Nenhum Registro Encontrado</strong>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<p-paginator [rows]="count" [style]="{'background-color': 'white', 'border': '1px solid white'}"
  [totalRecords]="paginas.totalElements" [rowsPerPageOptions]="[5, 10, 20, 30, 50, 100]"
  (onPageChange)="getPaginarUrl()"></p-paginator>

<p-toast [style]="{marginTop: '80px'}"></p-toast>